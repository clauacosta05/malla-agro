<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Malla Curricular Interactiva</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f0f0f0;
      margin: 0;
      padding: 20px;
    }
    h1 {
      text-align: center;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
    }
    .semestre {
      background: #fff;
      border: 2px solid #333;
      border-radius: 8px;
      padding: 10px;
    }
    .semestre h2 {
      margin-top: 0;
      text-align: center;
      font-size: 1.2em;
    }
    .ramo {
      cursor: pointer;
      background: #a7e6b0; /* verde claro */
      margin: 5px 0;
      padding: 8px;
      text-align: center;
      border-radius: 4px;
      font-weight: bold;
      transition: all 0.3s ease;
    }
    .ramo.aprobado {
      background: #4caf50;
      color: #fff;
      text-decoration: line-through;
    }
    .ramo.bloqueado {
      background: #ccc;
      color: #666;
      cursor: not-allowed;
      text-decoration: none;
    }
  </style>
</head>
<body>
  <h1>Malla Curricular Interactiva</h1>
  <div class="grid" id="malla"></div>

  <script>
    // Construcción de la malla desde tu archivo DOCX
    const malla = [
      {
        semestre: "Primer Año - I Semestre",
        ramos: [
          { id: "tecnicas_comunicacion", nombre: "TÉCNICAS DE COMUNICACIÓN", prereqs: [] },
          { id: "biologia_general", nombre: "BIOLOGÍA GENERAL", prereqs: [] },
          { id: "bases_agronomia", nombre: "BASES DE LA AGRONOMÍA", prereqs: [] },
          { id: "quimica_general", nombre: "QUIMICA GENERAL", prereqs: [] },
          { id: "matematica1", nombre: "MATEMATICA I", prereqs: [] }
        ]
      },
      {
        semestre: "Primer Año - II Semestre",
        ramos: [
          { id: "complementaria1", nombre: "COMPLEMENTARIA 1", prereqs: [] },
          { id: "tic", nombre: "MANEJOS DE TECNOLOGÍAS DE INFORMACIÓN Y COMUNICACIÓN", prereqs: ["tecnicas_comunicacion"] },
          { id: "anatomia_vegetal", nombre: "ANATOMÍA VEGETAL (AGRONOMÍA)", prereqs: ["biologia_general"] },
          { id: "quimica_analitica", nombre: "ELEMENTOS DE QUÍMICA ANALÍTICA CUANTITATIVA", prereqs: ["quimica_general"] },
          { id: "quimica_organica", nombre: "QUIMICA ORGÁNICA", prereqs: ["quimica_general"] },
          { id: "matematica2", nombre: "MATEMATICA II", prereqs: ["matematica1"] },
          { id: "fisica_general", nombre: "FISICA GENERAL", prereqs: ["matematica1"] }
        ]
      },
      {
        semestre: "Segundo Año - III Semestre",
        ramos: [
          { id: "calculo", nombre: "CÁLCULO", prereqs: ["matematica2"] },
          { id: "bioquimica", nombre: "BIOQUÍMICA", prereqs: ["quimica_organica", "biologia_general"] },
          { id: "botanica_sistematica", nombre: "BOTÁNICA SISTEMÁTICA", prereqs: ["anatomia_vegetal"] },
          { id: "microbiologia", nombre: "MICROBIOLOGÍA", prereqs: ["quimica_organica", "biologia_general"] },
          { id: "biofisica_agricola", nombre: "BIOFÍSICA AGRÍCOLA", prereqs: ["matematica2", "fisica_general"] },
          { id: "complementaria2", nombre: "COMPLEMENTARIA 2", prereqs: [] },
          { id: "complementaria3", nombre: "COMPLEMENTARIA 3", prereqs: [] }
        ]
      },
      {
        semestre: "Segundo Año - IV Semestre",
        ramos: [
          { id: "modelacion_cartografica", nombre: "MODELACIÓN CARTOGRÁFICA", prereqs: ["calculo", "fisica_general"] },
          { id: "fisiologia_vegetal", nombre: "FISIOLOGÍA VEGETAL", prereqs: ["bioquimica", "quimica_analitica"] },
          { id: "genetica_general", nombre: "GENÉTICA GENERAL", prereqs: ["bioquimica", "anatomia_vegetal"] },
          { id: "edafologia", nombre: "EDAFOLOGÍA", prereqs: ["biofisica_agricola"] },
          { id: "taller_integrado1", nombre: "TALLER INTEGRADO I", prereqs: ["bioquimica", "biofisica_agricola", "botanica_sistematica"] },
          { id: "anatomia_fisiologia_animal", nombre: "ANATOMÍA Y FISIOLOGÍA ANIMAL", prereqs: ["bioquimica", "microbiologia"] },
          { id: "bioestadistica", nombre: "BIOESTADÍSTICA", prereqs: [] },
          { id: "complementaria4", nombre: "COMPLEMENTARIA 4", prereqs: [] }
        ]
      },
    ];

    // Estado persistente
    let estado = JSON.parse(localStorage.getItem("estadoMalla")) || {};

    function crearMalla() {
      const contenedor = document.getElementById("malla");
      contenedor.innerHTML = "";

      malla.forEach(sem => {
        const semDiv = document.createElement("div");
        semDiv.className = "semestre";

        const titulo = document.createElement("h2");
        titulo.textContent = sem.semestre;
        semDiv.appendChild(titulo);

        sem.ramos.forEach(ramo => {
          const div = document.createElement("div");
          div.className = "ramo";
          div.id = ramo.id;
          div.textContent = ramo.nombre;

          // ¿está bloqueado?
          let bloqueado = ramo.prereqs.some(pr => !estado[pr]);

          if (bloqueado) {
            div.classList.add("bloqueado");
          } else if (estado[ramo.id]) {
            div.classList.add("aprobado");
          }

          div.addEventListener("click", () => {
            if (div.classList.contains("bloqueado")) {
              alert("Este ramo está bloqueado por prerrequisitos.");
              return;
            }
            div.classList.toggle("aprobado");
            estado[ramo.id] = div.classList.contains("aprobado");
            localStorage.setItem("estadoMalla", JSON.stringify(estado));
            crearMalla(); // recargar para actualizar bloqueos
          });

          semDiv.appendChild(div);
        });

        contenedor.appendChild(semDiv);
      });
    }

    crearMalla();
  </script>
</body>
</html>
